---
layout: post
title: Using Mono 2.4 on coLinux to ease .NET development
date: 2009-03-31
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
Currently I deal a lot with .NET development in my daily work. Most of the development is done on <span style="font-style:italic;">Windows</span>. When you need to develop cross-platform .NET you would like to use <a href="http://mono-project.com/">Mono</a>. Mono is binary compatible with .NET and allows .NET applications to run on Linux distributions. If you would develop from Visual Studio you want to easily test the binary directly in a mono session on Linux!<br /><br />To test software both platforms in a convenient way mostly virtualization is chosen. Of course you can use VMware or VirtualBox when you use Windows, but you can also use <a href="http://www.colinux.org/">coLinux</a>. coLinux is a port of the Linux kernel that allows it to run cooperatively alongside another operating system on a single machine. My choice of distribution to use on top of coLinux is the open version of SUSE, both supported by Novell.<br /><br /><span style="font-style:italic;">This description does expect you to have understanding of a Linux environment and administrative rights on your Windows system.</span><br /><br /><span style="font-weight:bold;">Installation (Windows side)</span><br />First of all you would need to coLinux installer. This file is available from the <a href="http://www.colinux.org/">coLinux website</a>. The <a href="http://sourceforge.net/project/showfiles.php?group_id=98788">downloads section</a> will point you to the latest stable, as of writing v0.7.3. On the website of <a href="http://www.henrynestler.com/">Henry Nestler</a> you can also find development and daily builds for 0.8.0. This installation is pretty straightforward, just keep the default settings. When the installer asks you 'Hardware installation' you need to press 'Continue anyways', this will allow the TAP network driver to be installed.<br /><br />To use a desktop environment from coLinux you need to install a X server. The more difficult way would be to use Cygwin/X... this way you will have a complete GNU system running on top of Windows to provide a Linux-like experience. The fastest and easy way is to use a tool like <a href="http://www.straightrunning.com/XmingNotes/">Xming</a>. The installer you need is the Xming or Xming-portablePuTTY (Mesa is not needed). Also, this installation is quite straightforward. After the installation start the X server from the start menu (Programs → Xming → Xming).<br /><br />In the posting '<a href="http://blog.gbraad.nl/2009/03/opensuse-111-on-colinux.html">openSUSE 11.1 on coLinux</a>' I described a way to make a base installation of openSUSE for use with the coLinux environment. The file 'colinux-opensuse-111.exe' (113Mb) [<a href="http://delivery.vipeers.com/file_sharing?message_hash=uxpWz6Au7DMjNs8-zlaFnA==">VIPeers</a>] [<a href="http://dl.getdropbox.com/u/131903/colinux-opensuse-11.1.exe">dropbox</a>] contains all you need to run the openSUSE environment. As you can see from the size, it contains only a base system. After you have extracted the file, you will still need to perform some additional installations to make the Mono development work.<br /><br />Before you start the Mono installation inside the coLinux environment, you need to reserve a directory for your development files or some other shared directory. I choose to use '<span style="font-style:italic;">D:\Development</span>'. In the <span style="font-style:italic;">run.txt</span> file in the openSUSE directory, you can add a line which says:<br /><code><br />cofs1="D:\Development"<br /></code><br />This will later be mounted inside the Linux environment.<br /><br /><span style="font-weight:bold;">Installation (Linux side)</span><br />Now you can start the environment from the '<span style="font-style:italic;">runonce.bat</span>'. This one time start is needed to finalize the installation (describe in the 'openSUSE on coLinux' posting as the post-install). You will see something similar to:<br /><br /><img style="width: 400px; height: 226px;" src="http://lh4.ggpht.com/_ZmgfsgbGDLs/ScVNslVwUgI/AAAAAAAAEB4/hVPU4voSaHA/s400/opensuse1.png" alt="openSUSE 11.1 started on coLinux 0.7.3" /><br /><br />Logon using the credentials: 'root' and the password 'password'. Immediately change the password using<br /><br /><div style="background:black;"><code><br />passwd<br /></code></div><br />Enable the network using the command:<br /><br /><div style="background:black;"><code><br />for i in 0 1<br />do<br />cat > /etc/sysconfig/network/ifcfg-eth$i << END<br />BOOTPROTO='dhcp'<br />STARTMODE='auto'<br />USERCONTROL='no'<br />END<br />done<br /></code></div><br />Add a mount point to your shared directory<br /><br /><div style="background:black;"><code><br />mkdir /media/Development<br />vi /etc/fstab<br /></code></div><br />and add the following line to this file<br /><br /><div style="background:black;"><code><br />cofs1    /media/Development  cofs     defaults        0 0<br /></code></div><br /><br />To enable the shared directory you need to mount it<br /><br /><div style="background:black;"><code><br />mount /media/Development<br /></code></div><br /><br />You can now shutdown...<br /><br /><div style="background:black;"><code><br />shutdown -hn now<br /></code></div><br /><br />... the system will halt and closes the console. From now on you are able to start the environment using the normal '<span style="font-style:italic;">run.bat</span>'. Do so and log on using your new password.<br /><br />Your network should now use <span style="font-style:italic;">eth0</span> as a serial line and <span style="font-style:italic;">eth1</span> as a bridged network using the device called 'Local Area Connection'. If your Windows network device is called differently, please change it in the '<span style="font-style:italic;">run.txt</span>' file. IP addresses are assigned using DHCP. The device <span style="font-style:italic;">eth0</span> will probably be assigned the address 10.0.2.15/24. For device <span style="font-style:italic;">eth1</span> this will depend on your local network settings. I will just assume that <span style="font-style:italic;">eth1</span> is configured and provides the Internet connection.<br /><br />To allow packages to be installed you would need to add the standard repositories to this installation.<br /><br /><div style="background:black"><code><br />zypper ar http://download.opensuse.org/distribution/11.1/repo/oss/ openSUSE111<br />zypper ar http://download.opensuse.org/distribution/11.1/repo/non-oss/ openSUSE111_NonOSS <br />zypper ar http://download.opensuse.org/update/11.1/ openSUSE-11.1-Updates<br /></code></div><br /><br /><span style="font-style:italic;">Enabling the User Interface</span><br />You can use a full-blown desktop environment as GNOME, but since coLinux does not provide a framebuffer device it is not advisable at the moment. We will use the Xming as the X server for our desktop. The X protocol is a client/server model for user interfaces. To keep the installation small, we use a very lightweight Desktop Environment on top of X, namely <a href="http://lxde.org/">LXDE</a>.<br /><br />Install the LXDE packages using:<br /><br /><div style="background:black;"><code><br />OCICLI http://download.opensuse.org/repositories/home:/swyear/openSUSE_11.1/LXDE-desktop.ymp<br /></code></div><br />This will start the One-Click-Install. You will need to agree to some questions and lean back... this might take some time.<br /><br />If this finished, you can test if the installation finished correctly. You will need to set the <span style="font-style:italic;">DISPLAY</span> parameter to specify where the X server is running. Now let's start the appearance settings...<br /><br /><div style="background:black;"><code><br />export DISPLAY=10.0.2.2:0.0<br />lxappearance<br /></code></div><br />and choose a theme that suits your current Windows theme.<br /><br /><img style="width: 400px;" src="http://lh4.ggpht.com/_ZmgfsgbGDLs/ScVNslVwUgI/AAAAAAAAEB4/hVPU4voSaHA/s400/opensuse1.png" alt="LX Appearance" /><br /><br />This means your desktop environment works.<br /><br />If you would receive a 'Gtk-WARNING **: cannot open display:' this means your connection might be blocked for some reason. Check your settings or disable a firewall/virus scanner.<br /><br /><span style="font-style:italic;">Mono installation</span><br />Mono will provide a Linux/Unix system with support to run .NET applications. Originally this description was written to use Mono 2.2 which was provided from the openSUSE repository. To install these packages issue a simple<br /><br /><div style="background:black;"><code><br />zypper in -t pattern devel_mono<br /></code></div><br />would be sufficient to install a development environment. To start the <span style="font-style:italic;">Monodevelop</span> you can start this using the command:<br /><br /><div style="background:black;"><code><br />export DISPLAY=10.0.2.2:0.0<br />monodevelop &<br /></code></div><br /><br /><img style="width: 400px;" src="http://lh4.ggpht.com/_ZmgfsgbGDLs/ScZWXVO8WHI/AAAAAAAAECA/tw29uAeVnII/s400/opensuse2.png" alt="Monodevelop" /><br /><br />Since the 30th of March a newer release of Mono (v2.4) is available. To install you will need to specify the mono repository and upgrade the previous installation.<br /><br /><div style="background:black;"><code><br />zypper addrepo http://ftp.novell.com/pub/mono/download-stable/openSUSE_11.1 mono-stable<br />zypper refresh --repo mono-stable<br />zypper dist-upgrade --repo mono-stable<br /></code></div><br /><br />You can now start <span style="font-style:italic;">Monodevelop 2.0</span> and use managed debugging!<br /><br />That's it for now... In later posts I will automate the startup and show how to do development using this environment.<br /><pre><br />Have a lot of fun...<br /></pre><br /><span style="font-weight:bold;">Notes</span><br />If you think VMware provides a better solution you can make use of the files that the Mono Project provide in their <a href="http://www.go-mono.com/mono-downloads/download.html">download section</a>. Either download the generated VMware image of the LiveCD.<br /><br />If you want to use GNOME as your desktop environment you are advised to remove the  <span style="font-style:italic;">gnome-screensaver</span> package and it's dependent, since it can cause issues during use. If you want to experiment with the LXDE environment, you are advised to use the <span style="font-style:italic;">lxpanel</span> and <span style="font-style:italic;">pcmanfm</span>. In a later post these will be explained in more detail.</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Ian</div>
<div class='content'>
I have a lot of respect for what you do. I don't even know how to change one widget which is causing a problem on my blog.</div>
</div>
</div>
