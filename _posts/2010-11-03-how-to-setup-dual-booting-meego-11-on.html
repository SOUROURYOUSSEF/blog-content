---
layout: post
title: "How-to setup dual-booting MeeGo 1.1 on the N900"
date: 2010-11-03
comments: false
categories:
 - arm
 - meego
 - nokia
 - installation
 - howto
 - fedora
 - maemo
 - n900
---

<div class='post'>
<div class="separator" style="clear: both; text-align: center;"><a href="http://www.flickr.com/photos/gbraad/5142954468/" imageanchor="1" style="clear:right; float:right; margin-left:1em; margin-bottom:1em"><img border="0" height="134" width="200" src="http://3.bp.blogspot.com/_ZmgfsgbGDLs/TNFgcVKurcI/AAAAAAAAIhE/hf7Wl-Dkmvs/s200/DSC00440.JPG"></img></a></div>The current image of MeeGo is for development purpose. Do NOT try to use it for daily use. You can make a phonecall or send a message, but I already had some issues with not being able to pick up phonecalls which I receive. It should be used as a means for developers to get familiar to the MeeGo environment for use on a handset. Also see the note at the end of this article.<br /><br />For this how-to I use Fedora 13, but tmost of the steps also apply to any other Linux distribution. Be sure you have downloaded the correct MeeGo images before you begin and that you have a MicroSD card of 2G or more. I used a 4G MicroSD card from SanDisk.<br /><br />The kernel root filesystem you download have to download from: <a href="http://repo.meego.com/MeeGo/releases/1.1/handset/images/meego-handset-armv7l-n900/">http://repo.meego.com/MeeGo/releases/1.1/handset/images/meego-handset-armv7l-n900/</a><br /><br />You need the following two files:<br />meego-handset-armv7l-n900-1.1-mmcblk0p.raw.bz2 (521M)<br />meego-handset-armv7l-n900-1.1-vmlinuz-2.6.35.3-10.3-n900 (1.5M)<br /><br /><b>N900</b><br />Enable the extras-devel repo on your device and install from app-manager: <a href="http://maemo.org/packages/view/uboot-pr13/">uboot-pr13</a> <br />or from the terminal with:<br /><br /><div style="color:white;background:black"><code> # root<br />$ apt-get install uboot-pr13<br /></code></div><br />Be sure you have upgraded to PR1.3 before doing this. This is all that's needed on the mobile handset.<br /><br /><b>Workstation</b><br />On Fedora you have to install the <i>uboot-tools</i> to create a bootable kernel image. For writing the disk image I also included <i>pv</i> to have some progress indication. Install these tools with:<br /><br /><div style="color:white;background:black"><code>$ yum install uboot-tools pv cfdisk<br /></code></div><br />Connect your N900 in Mass Storage mode with the MicroSD card inserted or use a multicard reader. As mentioned before, use a 2G or more MicroSD card to dump the raw image to. You have to find the correct device to use from e.g. the <i>dmesg</i>, replace <i>sdX</i> with the correct device. The command for this is:<br /><br /><div style="color:white;background:black"><code>$ bzcat meego-handset-armv7l-n900-1.1-mmcblk0p.raw.bz2 | pv | sudo dd bs=4096 of=/dev/sdX<br /></code></div><br />Note: This may take some time, especially on the class of SD card you are using. I used just a class 2 4GB from SanDisk. Also be sure it is not mounted during this action. Some distributions use auto-mounting for Removable Media.<br /><br />To make the MicroSD card usable for dual-booting you have to add a third partition. This might be a little more tricky if you haven't done this often. That is why you can use <i>cfdisk</i>.<br /><br /><div style="color:white;background:black"><code>$ cfdisk /dev/sdX<br /></code></div><br />And add a new partition in the last freespace you see. The first is only 1.3MB, which is TOO small to contain the kernel image. Define it as a primary partition of 4MB (or full size). Take note of the device name. It should be <i>sdX3</i>.<br /><br />Now create a FAT filesystem on the newly created partition. This is where your kernel needs to be placed.<br /><div style="color:white;background:black"><code>$ mkfs.vfat /dev/sdX3<br /></code></div><br />Now you need to prepare the kernel image for use on the SD card.<br /><div style="color:white;background:black"><code>$ mkimage -A arm -O linux -T kernel -C none -a 80008000 -e 80008000 -n meego-handset-armv7l-n900-1.1-vmlinuz-2.6.35.3-10.3-n900 -d meego-handset-armv7l-n900-1.1-vmlinuz-2.6.35.3-10.3-n900 uImage<br /></code></div><br />You would now have a file called <i>uImage</i> which you need to place in the FAT filesystem on <i>/dev/sdX3</i>. If you have difficulty creating the file, you can download it from <a href="http://files.gbraad.nl/meego/firmware/n900/meego-1.1-uImage.bin">here</a>. Be sure you rename it to <i>uImage</i>. Temporarily mount it or reinsert the SD card so auto-mount can deal with it. Copy the <i>uImage</i> file to the root and unmount.<br /><br />Now you could use this MicroSD to boot MeeGo 1.1. Try it out by powering off your N900 phone, remove the backcover and place the SD card. Be sure you have placed the backcover before you power on the device. If you don't do so, the root filesystem can not be mounted and the device will show a <a href="http://www.flickr.com/photos/gbraad/5142350005/">kernel panic</a>.<br /><br /><p><object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width="565" height="453" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="src" value="http://www.youtube.com/v/2PQDZypO-5Y?fs=1&amp;hl=en_US" /><param name="allowfullscreen" value="true" /><embed type="application/x-shockwave-flash" width="565" height="453" src="http://www.youtube.com/v/2PQDZypO-5Y?fs=1&amp;hl=en_US" allowscriptaccess="always" allowfullscreen="true"></embed></object></p><br /><b>External links</b><br /><ul><li><a href="http://wiki.meego.com/ARM/N900/Install/MMC#Installing_Rootfs_on_external_MMC_card">Install root filesystem on external card</a></li><li><a href="http://al.robotfuzz.com/~al/maemo/u-boot/">U-Boot for N900</a></li><li><a href="http://wiki.meego.com/ARM/N900">MeeGo for Nokia N900</a></li></ul><br /><b>Note</b><br />I do not take any responsibility in you damaging your device or loosing data during the process. As I had mentioned, it is intended for development use and therefore I hope you have some basic understanding of what you are doing. If you have any question, please post them in the <a href="http://forum.meego.com/forumdisplay.php?f=7">MeeGo Handset forum</a>.</div>
