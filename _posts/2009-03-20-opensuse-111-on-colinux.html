---
layout: post
title: "openSUSE 11.1 on coLinux"
date: 2009-03-20
comments: false
categories:
 - colinux
 - opensuse
 - linux
 - installation
---

<div class='post'>
To ease cross-platform .NET development, I have installed openSUSE on coLinux. This allows me to develop from <span style="font-style:italic;">Windows</span> and also test and debug the binary on Linux. Advantages are: No need to dual boot and a much better performance than using VMware or other virtualization solution. In this article you can find the base system and I will describe how I did the base installation.<br /><br /><span style="font-style:italic;">Take note, these instructions do NOT provide any details about the .NET environment. Those are published on my <a href="http://dotnet.gbraad.nl/2009/03/using-mono-24-on-colinux-to-ease-net.html">.NET blog</a>.</span><br /><br /><img style="width: 400px;" src="http://lh4.ggpht.com/_ZmgfsgbGDLs/ScZWXVO8WHI/AAAAAAAAECA/tw29uAeVnII/s400/opensuse2.png" alt="Monodevelop" /><br /><br />The files to install and run the environment '<span style="font-style:italic;">colinux-opensuse-11.1.exe</span>' can be found at [<a href="http://delivery.vipeers.com/file_sharing?message_hash=uxpWz6Au7DMjNs8-zlaFnA==">VIPeers</a>], [<a href="http://dl.getdropbox.com/u/131903/colinux-opensuse-11.1.exe">dropbox</a>] (113Mb). This file contains the base <span style="font-style:italic;">system.img</span>, a swap image and start commands. If you don't want to install it yourself, you can at least immediately start to use openSUSE on coLinux. Take note, network has not been configured yet (see notes). The user account is 'root' with the password 'password'.<br /><br /><span style="font-weight:bold;">Preparation</span><br />The installation closely follows the instructions I wrote for <a href="http://blog.gbraad.nl/2009/03/manually-installing-centos-52-on.html">CentOS</a>. You will need a clean <span style="font-style:italic;">system.img</span> which you can find in the <a href="http://dl.getdropbox.com/u/131903/colinux-centos52-base.rar">colinux-centos52-base.rar</a>. Copy the Debian businnesscard init ramdisk to install_initrd.gz. And of course you need to download the openSUSE 11.1 DVD from <a href="http://www.opensuse.org/">http://www.opensuse.org/</a>. This file will be about 4.25GB in size.<br /><br />You can perform a RPM installation, but since openSUSE provides an image-based installation I will use this for the base of the coLinux environment. My main purpose was to keep the installation easy to perform (and if possible small in size). Copy the files <span style="font-style:italic;">base-i386.tar.lzma</span>, <span style="font-style:italic;">base-meta-i386.tar.lzma</span> and <span style="font-style:italic;">common-base-i386.tar.lzma</span> from the openSUSE 11.1 DVD. It is located in the directory <span style="font-style:italic;">images</span>. Since the Debian initrd does not contain the lzma binary, so you will need to decompress the archives with a tool like 7-Zip. The resulting files will be standard tape-archives. Place them in a directory called '<span style="font-style:italic;">images</span>'. The <span style="font-style:italic;">install.bat</span> will map it to <span style="font-style:italic;">cofs1</span>.<br /><br /><span style="font-weight:bold;">Installation</span><br />If you have the install files from the opensuse-11.1.exe file, the <span style="font-style:italic;">images</span>, debian's <span style="font-style:italic;">install_initrd.gz</span> and the <span style="font-style:italic;">system.img</span> from the centos52-base.rar, you are ready to go.<br /><br />Start the <span style="font-style:italic;">install.bat</span>. You will see a debian installation screen... toggle with ALT-F2 to a console and press Enter.<br /><br /><code>   Please press Enter to activate this console.</code><br /><br /><img style="width: 400px; height: 226px;" src="http://lh6.ggpht.com/_ZmgfsgbGDLs/Sb63brlBLtI/AAAAAAAAEAY/chtkT6AMxk4/s400/install2.png" border="0" alt="Please press Enter to activate this console. BusyBox v1.10.2 (Debian 1:1.10.2-2) built-in shell (ash) Enter 'help' for a list of built-in commands." /><br /><br />From here you can perform the following commands. The line which says '<span style="font-style:italic;">tar -C /mnt/linux -xf $i</span>' will unpack the image to the <span style="font-style:italic;">system.img</span>. Just be sure to have some coffee ready since it might take some time.<br /><br /><div style="background:black"><code><br />mkswap /dev/cobd7<br />swapon /dev/cobd7<br /><br />mkdir /mnt/linux<br />mkdir /mnt/win<br />mount /dev/cobd0 /mnt/linux<br />mount -t cofs cofs0 /mnt/win<br /><br />mkdir /mnt/images<br />mount -t cofs cofs1 /mnt/images<br />cd /mnt/images<br /><br />for i in *.tar<br />do<br />tar -C /mnt/linux -xf $i<br />done<br /><br />mkdir -p /mnt/linux/media/cdrom<br />mount /dev/cobd1 /mnt/linux/media/cdrom<br /><br />chroot /mnt/linux<br />cd /media/cdrom/suse/i586<br /><br />rpm -ivh openSUSE-release-[0-9]*.rpm \<br />openSUSE-release-dvd-[0-9]*.rpm<br /><br />echo password | passwd - stdin root <br /><br />cat > /etc/fstab << END<br />/dev/cobd0 / ext3 acl,user_xattr 1 1<br />/dev/cobd7 swap swap defaults 0 0<br />proc /proc proc defaults 0 0<br />devpts /dev/pts devpts gid=5,mode=620 0 0<br />sysfs /sys sysfs noauto 0 0<br />debugfs /sys/kernel/debug debugfs noauto 0 0<br />END<br /><br />exit<br /></code></div><br /><br />After this you can <span style="font-style:italic;">halt</span> the system. And start it for the first time.<br /><br /><span style="font-weight:bold;">Post-install</span><br />To finish the installation you need to start it with the coLinux initrd once. The script <span style="font-style:italic;">runonce.bat</span> will take care of that... after you have run it, openSUSE will start properly. Log on and halt again. After this you can start it without a initrd being specified. The script <span style="font-style:italic;">run.bat</span> will start the final system.<br /><br /><img style="width: 400px; height: 226px;" src="http://lh4.ggpht.com/_ZmgfsgbGDLs/ScVNslVwUgI/AAAAAAAAEB4/hVPU4voSaHA/s400/opensuse1.png" alt="openSUSE 11.1 started on coLinux 0.7.3" /><br /><br />It might give some startup errors... nothing serious. I didn't configure the network inside the base system. This can be done using <span style="font-style:italic;">yast</span> or perform the following command:<br /><br /><div style="background:black;"><code><br />for i in 0 1<br />do<br />cat > /etc/sysconfig/network/ifcfg-eth$i << END<br />BOOTPROTO='dhcp'<br />BROADCAST=''<br />ETHTOOL_OPTIONS=''<br />IPADDR=''<br />MTU=''<br />NAME=''<br />NETMASK=''<br />NETWORK=''<br />REMOTE_IPADDR=''<br />STARTMODE='auto'<br />USERCONTROL='no'<br />END<br />done<br /></code></div><br /><br />This enables both <span style="font-style:italic;">eth0</span> and <span style="font-style:italic;">eth1</span> to use DHCP. Kernel modules can be installed with the same RPM I have provided earlier. Just use the following commands:<br /><br /><div style="background:black"><code><br />zypper in http://gbraad.fedorapeople.org/files/kernel-modules-2.6-co0.7.3.i386.rpm<br /></code></div><br /><br /><span style="font-weight:bold;">Alternative installation</span><br />If you want to perform a RPM-based installation you will still need to install the <span style="font-style:italic;">base-i386.tar</span> image. I tried without, but ended up with a lot of errors during installation. The can find the installation instructions in the file <a href="http://dl.getdropbox.com/u/131903/opensuse-instructions-rpm.txt">instructions-rpm.txt</a> which is included in the archive. Eventually I have not further tested this alternative installation...<br /><br /><span style="font-weight:bold;">Notes</span><br />I have tried to only use the files provided by openSUSE, but somehow they seem to consume too much time. The common filesystem did not provide all the tools I needed (similar to the stage2.img from redhat). If you know another way to install it, let me know. Qemu can also install it, but it consumes a lot more time in my opinion; install, <span style="font-style:italic;">dd</span>, etc.<br /><br />For the moment it is not possible to perform an image installation without the openSUSE DVD installation media. I do hope they will provide a single CD image installer or provide the images from their <a href="http://download.opensuse.org/distribution/11.1/">11.1 download</a> site. If it is possible, please enlighten me?!<br /><br />If you want to install additional software, you will need to add the openSUSE repositories. This can easily be done using <span style="font-style:italic;">zypper</span>.<br /><br /><div style="background:black"><code><br />zypper ar http://download.opensuse.org/distribution/11.1/repo/oss/ openSUSE111<br />zypper ar http://download.opensuse.org/distribution/11.1/repo/non-oss/ openSUSE111_NonOSS <br />zypper ar http://download.opensuse.org/update/11.1/ openSUSE-11.1-Updates<br /></code></div><br /><br />Now you can install Gnome by using a command like:<br /><br /><div style="background:black"><code><br />zypper in -t pattern gnome<br /></code></div><br /><br />More information about installing software can be found on <a href="http://opensuse-tutorials.com/2008/07/zypper-tips-and-tricks/">openSUSE Tutorials</a>.<br /><pre><br />Have a lot of fun...<br /></pre></div>
